{
    auto_https off
}

:80 {
    root * /srv
    encode zstd gzip

    try_files {path} {path} .html {path} / /index.html

    file_server

    @assets {
                path /assets/* *.js *.css *.woff *.woff2 *.ttf *.eot
            }
    handle @assets {
                       header Cache-Control "public, max-age=31536000, immutable"
                       file_server
                   }

    header {
               Strict-Transport-Security "max-age=31536000; includeSubDomains"
               X-Content-Type-Options "nosniff"
               X-Frame-Options "DENY"
               Referrer-Policy "strict-origin-when-cross-origin"
               Permissions-Policy "geolocation=(), microphone=(), camera=()"

               Content-Security-Policy "
                    default-src 'self';
                    img-src 'self' data:;
                    script-src 'self';
                    style-src 'self' 'unsafe-inline' https://fonts.bunny.net;
                    font-src 'self' data: https://fonts.bunny.net;
                    connect-src 'self' https:;
                    object-src 'none';
                    frame-ancestors 'none';
                    base-uri 'self';
               "
           }

    handle_errors {
                      rewrite * /index.html
                      file_server
                  }
}
